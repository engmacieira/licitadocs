# ğŸ”– Release Notes: v0.3.0 - Admin & Concierge Mode

**Data:** 17/01/2026
**VersÃ£o Anterior:** v0.2.0 (Auth & QA)
**Status:** EstÃ¡vel (Backend)

---

## ğŸ“¢ Resumo da VersÃ£o
Esta versÃ£o marca o **pivÃ´ estratÃ©gico** do produto LicitaDoc na Sprint 03.
A arquitetura foi alterada de um modelo "Auto-ServiÃ§o" para um modelo "Concierge" (Multi-Tenant), onde administradores operam o sistema em nome dos clientes.

Foi introduzido o conceito de **RBAC (Role-Based Access Control)** e fluxos exclusivos para superusuÃ¡rios.

---

## âœ¨ Novas Funcionalidades (Changelog)

### ğŸ‘®â€â™‚ï¸ GestÃ£o e SeguranÃ§a (Admin)
* **Hierarquia de UsuÃ¡rios:** Adicionado campo `role` no banco de dados.
    * `admin`: Acesso irrestrito a todas as empresas.
    * `client`: Acesso somente-leitura Ã  prÃ³pria empresa.
* **Middleware de ProteÃ§Ã£o:** DependÃªncia `get_current_active_admin` bloqueia rotas sensÃ­veis contra acesso nÃ£o autorizado.
* **Seed Script:** Ferramenta `scripts/create_first_admin.py` para gerar o primeiro superusuÃ¡rio do sistema via terminal.

### ğŸ­ Fluxo de Documentos (Concierge)
* **Upload por Terceiros:** O endpoint `POST /documents/upload` agora aceita `target_company_id`. Isso permite que o Admin envie arquivos diretamente para a carteira de um cliente especÃ­fico.
* **Listagem de Clientes:** Novo endpoint `GET /admin/companies` para alimentar o painel de seleÃ§Ã£o de empresas do Backoffice.

### ğŸ› CorreÃ§Ãµes e Melhorias
* **Fix de CNPJ:** O cadastro de empresas agora gera um CNPJ randÃ´mico temporÃ¡rio para evitar travamento do banco (`IntegrityError`) ao criar mÃºltiplos usuÃ¡rios de teste.
* **OrganizaÃ§Ã£o:** SeparaÃ§Ã£o das rotas administrativas em `admin_router.py`.

---

## ğŸ—ï¸ AlteraÃ§Ãµes no Banco de Dados
* **Tabela `users`:** Adicionada coluna `role` (String/Enum).
* **Tabela `companies`:** CNPJ agora Ã© gerado dinamicamente no registro (antes era hardcoded).

## ğŸ§ª Qualidade (QA)
* Bateria de testes expandida para **12 cenÃ¡rios**, cobrindo:
    * Bloqueio de acesso (Cliente tentando acessar rota de Admin).
    * Upload administrativo em nome de terceiros.
    * Integridade dos dados entre diferentes empresas.

---

## ğŸ”® PrÃ³ximos Passos (Sprint 04)
* IntegraÃ§Ã£o com **Google Gemini AI**.
* Leitura automÃ¡tica de PDF (OCR/Texto).
* AnÃ¡lise jurÃ­dica automÃ¡tica (Resumo e Validade).