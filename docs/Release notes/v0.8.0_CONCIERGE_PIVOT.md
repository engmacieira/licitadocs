# ğŸ“¦ VersÃ£o v0.8.0: O Modelo Concierge (MVP)

**Data:** 02/02/2026
**Tag:** `v0.8.0`
**Codinome:** The Concierge Pivot

## ğŸ¯ VisÃ£o Geral
Esta versÃ£o marca a mudanÃ§a estratÃ©gica do produto de um "Drive de Arquivos" para uma plataforma de "GestÃ£o Concierge".
* **Antes:** O cliente fazia upload e geria seus documentos.
* **Agora:** O cliente apenas consulta. A equipe LicitaDoc (Admin) gerencia, valida e sobe os arquivos. A IA atua como consultora contextual.

---

## âœ¨ Novas Funcionalidades (Frontend)

### ğŸ‘® Ãrea Operacional (Admin)
* **Novo Dashboard Admin (`/admin/dashboard`):** Lista visual de todas as empresas clientes cadastradas.
* **Upload Administrativo (`/admin/upload`):**
    * Seletor de "Empresa Alvo" (Tenant).
    * Campo obrigatÃ³rio de **Data de Validade** (para gestÃ£o de vencimentos).
    * Upload em nome de terceiros.

### ğŸ¢ Ãrea do Cliente (Vitrine)
* **Dashboard Read-Only:** RemoÃ§Ã£o de botÃµes de ediÃ§Ã£o/exclusÃ£o/upload para o perfil `client`.
* **SemÃ¡foro de Validade:** Badges visuais automÃ¡ticos:
    * ğŸŸ¢ **VÃ¡lido:** Em dia.
    * ğŸŸ¡ **AtenÃ§Ã£o:** Vence em < 30 dias.
    * ğŸ”´ **Vencido:** Data de validade expirada.
* **Chat Widget:** BotÃ£o flutuante no canto inferior direito para tirar dÃºvidas sem sair da tela.

### ğŸ” Fluxo & AutenticaÃ§Ã£o
* **Login Inteligente:** Redirecionamento automÃ¡tico baseado na Role:
    * `admin` -> `/admin/dashboard`
    * `client` -> `/dashboard`

---

## âš™ï¸ Backend & Arquitetura

### ğŸ—„ï¸ Banco de Dados (SQLite/SQLAlchemy)
* **AlteraÃ§Ã£o na Tabela `documents`:**
    * Adicionado `expiration_date` (DateTime): Para controle de vencimento.
    * Adicionado `uploaded_by_id` (FK): Auditoria de quem enviou o arquivo (Admin ou Cliente).
    * Adicionado `status` (Enum): PreparaÃ§Ã£o para status `VALID`, `WARNING`, `EXPIRED`.

### ğŸ”Œ API Endpoints
* **`POST /documents/upload`:** Refatorado para aceitar `target_company_id` (apenas Admins) e `expiration_date`.
* **`GET /users/me`:** Novo endpoint para o Frontend identificar a Role do usuÃ¡rio logado.
* **`POST /ai/chat`:** ImplementaÃ§Ã£o de **RAG (Retrieval Augmented Generation)** simples.
    * O endpoint agora busca os metadados dos documentos do cliente no banco.
    * Injeta a lista de documentos no System Prompt da IA antes de responder.

### ğŸ§  InteligÃªncia Artificial (Google Gemini)
* **MigraÃ§Ã£o de Lib:** `google.generativeai` (v1/Deprecated) -> `google-genai` (v2/Stable).
* **Persona "BibliotecÃ¡rio":** O System Prompt foi configurado para responder *apenas* sobre os documentos existentes no cofre, ignorando perguntas fora de contexto (futebol, polÃ­tica, etc).

---

## âš ï¸ Notas de AtualizaÃ§Ã£o (Breaking Changes)

Esta versÃ£o altera o schema do banco de dados. Para rodar em ambiente local ou produÃ§Ã£o:

1.  **DependÃªncias Python:**
    ```bash
    pip uninstall google-generativeai
    pip install google-genai
    ```
2.  **DependÃªncias Frontend:**
    ```bash
    npm install date-fns
    ```
3.  **Banco de Dados:**
    * NecessÃ¡rio resetar o banco SQLite local (devido Ã  falta de migraÃ§Ãµes Alembic no momento).
    ```bash
    rm licita_doc.db
    uvicorn app.main:app --reload
    python -m app.scripts.create_first_admin
    ```

---

## ğŸ› Bugs Corrigidos
* CorreÃ§Ã£o de erro `AttributeError` na classe `AIClient` apÃ³s migraÃ§Ã£o de lib.
* CorreÃ§Ã£o de rotas duplicadas no `document_router.py`.
* CorreÃ§Ã£o de importaÃ§Ã£o no `Login/index.tsx` (Named Export).